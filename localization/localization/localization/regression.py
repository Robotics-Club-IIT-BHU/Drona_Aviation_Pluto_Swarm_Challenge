import numpy as np
from sklearn.linear_model import LinearRegression
from sklearn.preprocessing import PolynomialFeatures

class Regression:
	def __init__(self):
		lin1, poly, lin2 = self.train_model(X, Y)
		self.lin1 = lin1
		self.poly = poly
		self.lin2 = lin2
	def simple_regression(self, tvec):
		x = tvec[..., :2][0]
		return [x[0]*0.8928, x[1]*0.9259]
	def linear_regression(self, tvec):
		x = tvec[..., :2]
		y = self.lin1.predict(tvec)
		return y[0]
	def polynomial_regression(self, tvec):
		x = tvec[..., :2]
		y = self.lin2.predict(self.poly.fit_transform(x))
		return y[0]
	def train_model(self, x, y):
		lin1 = LinearRegression()
		lin1.fit(x, y)
		poly = PolynomialFeatures(degree=4)
		x_poly = poly.fit_transform(x)
		poly.fit(x_poly, y)
		lin2 = LinearRegression()
		lin2.fit(x_poly, y)
		return lin1, poly, lin2

X = np.array([[-100,-100], [-75,-100], [-50,-100], [-25,-100], [0,-100], [25,-100], [75,-100], [100,-100],
			  [-100,-75],  [-75,-75],  [-50,-75],  [-25,-75],  [0,-75],  [25,-75],  [75,-75],  [100,-75],
			  [-100,-50],  [-75,-50],  [-50,-50],  [-25,-50],  [0,-50],  [25,-50],  [75,-50],  [100,-50],
			  [-100,-25],  [-75,-25],  [-50,-25],  [-25,-25],  [0,-25],  [25,-25],  [75,-25],  [100,-25],
			  [-100,0],    [-75,0],    [-50,0],    [-25,0],    [0,0],    [25,0],    [75,0],    [100,0],
			  [-100,25],   [-75,25],   [-50,25],   [-25,25],   [0,25],   [25,25],   [75,25],   [100,25],
			  [-100,50],   [-75,50],   [-50,50],   [-25,50],   [0,50],   [25,50],   [75,50],   [100,50],
			  [-100,75],   [-75,75],   [-50,75],   [-25,75],   [0,75],   [25,75],   [75,75],   [100,75],
			  [-100,100],  [-75,100],  [-50,100],  [-25,100],  [0,100],  [25,100],  [75,100],  [100,100]])
Y = np.array([[-100,-100], [-75,-100], [-50,-100], [-25,-100], [0,-100], [25,-100], [75,-100], [100,-100],
			  [-100,-75],  [-75,-75],  [-50,-75],  [-25,-75],  [0,-75],  [25,-75],  [75,-75],  [100,-75],
			  [-100,-50],  [-75,-50],  [-50,-50],  [-25,-50],  [0,-50],  [25,-50],  [75,-50],  [100,-50],
			  [-100,-25],  [-75,-25],  [-50,-25],  [-25,-25],  [0,-25],  [25,-25],  [75,-25],  [100,-25],
			  [-100,0],    [-75,0],    [-50,0],    [-25,0],    [0,0],    [25,0],    [75,0],    [100,0],
			  [-100,25],   [-75,25],   [-50,25],   [-25,25],   [0,25],   [25,25],   [75,25],   [100,25],
			  [-100,50],   [-75,50],   [-50,50],   [-25,50],   [0,50],   [25,50],   [75,50],   [100,50],
			  [-100,75],   [-75,75],   [-50,75],   [-25,75],   [0,75],   [25,75],   [75,75],   [100,75],
			  [-100,100],  [-75,100],  [-50,100],  [-25,100],  [0,100],  [25,100],  [75,100],  [100,100]])